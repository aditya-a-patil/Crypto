import requests, json

import sched, time
s = sched.scheduler(time.time, time.sleep)

global url, headers
server = '127.0.0.1'
port = '80'
url = {}
headers = {}

#Logging
#import logging
#logging.basicConfig(format='[%(levelname)s]: %(message)s', level=logging.DEBUG)

def setupNetworkStrings(server, port):

	if 'http' in server:
		host = server+':'+port
	else:
		host = 'http://'+server+':'+port

	url['lookupUsers'] = host+'/lookupUsers'
	url['lookupKey'] = host+'/lookupKey/'
	url['registerKey'] = host+'/registerKey/'
	url['getMessages'] = host+'/getMessages/'
	url['sendMessage'] = host+'/sendMessage/'
	headers['content-type'] = 'application/json'

def getMessages(user):
	r = requests.get(url['getMessages']+str(user), headers=headers)
	print r
	print r.text

if __name__ == "__main__":

	setupNetworkStrings(server, port)

	while 1==1:
		s.enter(0.5, 1, getMessages, ('aloce1',))
		s.run()